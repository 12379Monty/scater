## Suite of functions for testing gene expression amplitude

testAmp.ttest.onegene <- function(log2cpm, design, test.variable = ncol(design)) {
    fit <- lm(log2cpm ~ 0 + design)
    summ <- summary(fit)
    logFC <- SE <- t.value <- p.value <- NA
    if( test.variable <= nrow(summ$coef) ) {
        logFC <- summ$coef[test.variable, 1]
        SE <- summ$coef[test.variable, 2]
        t.value <- summ$coef[test.variable, 3]
        p.value <- summ$coef[test.variable, 4]
    }
    N <- length(log2cpm)
    data.frame(logFC, SE, N, t.value, p.value)
}
